{
  "version": 3,
  "sources": ["../../simple-mind-map/src/utils/simulateCSSBackgroundInCanvas.js", "../../simple-mind-map/src/parse/toMarkdown.js", "../../simple-mind-map/src/parse/toTxt.js", "../../simple-mind-map/src/plugins/Export.js"],
  "sourcesContent": ["// 将以空格分隔的字符串值转换成成数字/单位/值数组\r\nconst getNumberValueFromStr = value => {\r\n  let arr = String(value).split(/\\s+/)\r\n  return arr.map(item => {\r\n    if (/^[\\d.]+/.test(item)) {\r\n      // 数字+单位\r\n      let res = /^([\\d.]+)(.*)$/.exec(item)\r\n      return [Number(res[1]), res[2]]\r\n    } else {\r\n      // 单个值\r\n      return item\r\n    }\r\n  })\r\n}\r\n\r\n// 缩放宽度\r\nconst zoomWidth = (ratio, height) => {\r\n  // w / height = ratio\r\n  return ratio * height\r\n}\r\n\r\n// 缩放高度\r\nconst zoomHeight = (ratio, width) => {\r\n  // width / h = ratio\r\n  return width / ratio\r\n}\r\n\r\n// 关键词到百分比值的映射\r\nconst keyWordToPercentageMap = {\r\n  left: 0,\r\n  top: 0,\r\n  center: 50,\r\n  bottom: 100,\r\n  right: 100\r\n}\r\n\r\n// 模拟background-size\r\nconst handleBackgroundSize = ({\r\n  backgroundSize,\r\n  drawOpt,\r\n  imageRatio,\r\n  canvasWidth,\r\n  canvasHeight,\r\n  canvasRatio\r\n}) => {\r\n  if (backgroundSize) {\r\n    // 将值转换成数组\r\n    let backgroundSizeValueArr = getNumberValueFromStr(backgroundSize)\r\n    // 两个值都为auto，那就相当于不设置\r\n    if (\r\n      backgroundSizeValueArr[0] === 'auto' &&\r\n      backgroundSizeValueArr[1] === 'auto'\r\n    ) {\r\n      return\r\n    }\r\n    // 值为cover\r\n    if (backgroundSizeValueArr[0] === 'cover') {\r\n      if (imageRatio > canvasRatio) {\r\n        // 图片的宽高比大于canvas的宽高比，那么图片高度缩放到和canvas的高度一致，宽度自适应\r\n        drawOpt.height = canvasHeight\r\n        drawOpt.width = zoomWidth(imageRatio, canvasHeight)\r\n      } else {\r\n        // 否则图片宽度缩放到和canvas的宽度一致，高度自适应\r\n        drawOpt.width = canvasWidth\r\n        drawOpt.height = zoomHeight(imageRatio, canvasWidth)\r\n      }\r\n      return\r\n    }\r\n    // 值为contain\r\n    if (backgroundSizeValueArr[0] === 'contain') {\r\n      if (imageRatio > canvasRatio) {\r\n        // 图片的宽高比大于canvas的宽高比，那么图片宽度缩放到和canvas的宽度一致，高度自适应\r\n        drawOpt.width = canvasWidth\r\n        drawOpt.height = zoomHeight(imageRatio, canvasWidth)\r\n      } else {\r\n        // 否则图片高度缩放到和canvas的高度一致，宽度自适应\r\n        drawOpt.height = canvasHeight\r\n        drawOpt.width = zoomWidth(imageRatio, canvasHeight)\r\n      }\r\n      return\r\n    }\r\n    // 图片宽度\r\n    let newNumberWidth = -1\r\n    if (backgroundSizeValueArr[0]) {\r\n      if (Array.isArray(backgroundSizeValueArr[0])) {\r\n        // 数字+单位类型\r\n        if (backgroundSizeValueArr[0][1] === '%') {\r\n          // %单位\r\n          drawOpt.width = (backgroundSizeValueArr[0][0] / 100) * canvasWidth\r\n          newNumberWidth = drawOpt.width\r\n        } else {\r\n          // 其他都认为是px单位\r\n          drawOpt.width = backgroundSizeValueArr[0][0]\r\n          newNumberWidth = backgroundSizeValueArr[0][0]\r\n        }\r\n      } else if (backgroundSizeValueArr[0] === 'auto') {\r\n        // auto类型，那么根据设置的新高度以图片原宽高比进行自适应\r\n        if (backgroundSizeValueArr[1]) {\r\n          if (backgroundSizeValueArr[1][1] === '%') {\r\n            // 高度为%单位\r\n            drawOpt.width = zoomWidth(\r\n              imageRatio,\r\n              (backgroundSizeValueArr[1][0] / 100) * canvasHeight\r\n            )\r\n          } else {\r\n            // 其他都认为是px单位\r\n            drawOpt.width = zoomWidth(imageRatio, backgroundSizeValueArr[1][0])\r\n          }\r\n        }\r\n      }\r\n    }\r\n    // 设置了图片高度\r\n    if (backgroundSizeValueArr[1] && Array.isArray(backgroundSizeValueArr[1])) {\r\n      // 数字+单位类型\r\n      if (backgroundSizeValueArr[1][1] === '%') {\r\n        // 高度为%单位\r\n        drawOpt.height = (backgroundSizeValueArr[1][0] / 100) * canvasHeight\r\n      } else {\r\n        // 其他都认为是px单位\r\n        drawOpt.height = backgroundSizeValueArr[1][0]\r\n      }\r\n    } else if (newNumberWidth !== -1) {\r\n      // 没有设置图片高度或者设置为auto，那么根据设置的新宽度以图片原宽高比进行自适应\r\n      drawOpt.height = zoomHeight(imageRatio, newNumberWidth)\r\n    }\r\n  }\r\n}\r\n\r\n// 模拟background-position\r\nconst handleBackgroundPosition = ({\r\n  backgroundPosition,\r\n  drawOpt,\r\n  imgWidth,\r\n  imgHeight,\r\n  canvasWidth,\r\n  canvasHeight\r\n}) => {\r\n  if (backgroundPosition) {\r\n    // 将值转换成数组\r\n    let backgroundPositionValueArr = getNumberValueFromStr(backgroundPosition)\r\n    // 将关键词转为百分比\r\n    backgroundPositionValueArr = backgroundPositionValueArr.map(item => {\r\n      if (typeof item === 'string') {\r\n        return keyWordToPercentageMap[item] !== undefined\r\n          ? [keyWordToPercentageMap[item], '%']\r\n          : item\r\n      }\r\n      return item\r\n    })\r\n    if (Array.isArray(backgroundPositionValueArr[0])) {\r\n      if (backgroundPositionValueArr.length === 1) {\r\n        // 如果只设置了一个值，第二个默认为50%\r\n        backgroundPositionValueArr.push([50, '%'])\r\n      }\r\n      // 水平位置\r\n      if (backgroundPositionValueArr[0][1] === '%') {\r\n        // 单位为%\r\n        let canvasX = (backgroundPositionValueArr[0][0] / 100) * canvasWidth\r\n        let imgX = (backgroundPositionValueArr[0][0] / 100) * imgWidth\r\n        // 计算差值\r\n        drawOpt.x = canvasX - imgX\r\n      } else {\r\n        // 其他单位默认都为px\r\n        drawOpt.x = backgroundPositionValueArr[0][0]\r\n      }\r\n      // 垂直位置\r\n      if (backgroundPositionValueArr[1][1] === '%') {\r\n        // 单位为%\r\n        let canvasY = (backgroundPositionValueArr[1][0] / 100) * canvasHeight\r\n        let imgY = (backgroundPositionValueArr[1][0] / 100) * imgHeight\r\n        // 计算差值\r\n        drawOpt.y = canvasY - imgY\r\n      } else {\r\n        // 其他单位默认都为px\r\n        drawOpt.y = backgroundPositionValueArr[1][0]\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 模拟background-repeat\r\nconst handleBackgroundRepeat = ({\r\n  ctx,\r\n  image,\r\n  backgroundRepeat,\r\n  drawOpt,\r\n  imgWidth,\r\n  imgHeight,\r\n  canvasWidth,\r\n  canvasHeight\r\n}) => {\r\n  if (backgroundRepeat) {\r\n    // 保存在handleBackgroundPosition中计算出来的x、y\r\n    let ox = drawOpt.x\r\n    let oy = drawOpt.y\r\n    // 计算ox和oy能平铺的图片数量\r\n    let oxRepeatNum = Math.ceil(ox / imgWidth)\r\n    let oyRepeatNum = Math.ceil(oy / imgHeight)\r\n    // 计算ox和oy第一张图片的位置\r\n    let oxRepeatX = ox - oxRepeatNum * imgWidth\r\n    let oxRepeatY = oy - oyRepeatNum * imgHeight\r\n    // 将值转换成数组\r\n    let backgroundRepeatValueArr = getNumberValueFromStr(backgroundRepeat)\r\n    // 不处理\r\n    if (\r\n      backgroundRepeatValueArr[0] === 'no-repeat' ||\r\n      (imgWidth >= canvasWidth && imgHeight >= canvasHeight)\r\n    ) {\r\n      return\r\n    }\r\n    // 水平平铺\r\n    if (backgroundRepeatValueArr[0] === 'repeat-x') {\r\n      if (canvasWidth > imgWidth) {\r\n        let x = oxRepeatX\r\n        while (x < canvasWidth) {\r\n          drawImage(ctx, image, {\r\n            ...drawOpt,\r\n            x\r\n          })\r\n          x += imgWidth\r\n        }\r\n        return true\r\n      }\r\n    }\r\n    // 垂直平铺\r\n    if (backgroundRepeatValueArr[0] === 'repeat-y') {\r\n      if (canvasHeight > imgHeight) {\r\n        let y = oxRepeatY\r\n        while (y < canvasHeight) {\r\n          drawImage(ctx, image, {\r\n            ...drawOpt,\r\n            y\r\n          })\r\n          y += imgHeight\r\n        }\r\n        return true\r\n      }\r\n    }\r\n    // 平铺\r\n    if (backgroundRepeatValueArr[0] === 'repeat') {\r\n      let x = oxRepeatX\r\n      while (x < canvasWidth) {\r\n        if (canvasHeight > imgHeight) {\r\n          let y = oxRepeatY\r\n          while (y < canvasHeight) {\r\n            drawImage(ctx, image, {\r\n              ...drawOpt,\r\n              x,\r\n              y\r\n            })\r\n            y += imgHeight\r\n          }\r\n        }\r\n        x += imgWidth\r\n      }\r\n      return true\r\n    }\r\n  }\r\n}\r\n\r\n// 根据参数绘制图片\r\nconst drawImage = (ctx, image, drawOpt) => {\r\n  ctx.drawImage(\r\n    image,\r\n    drawOpt.sx,\r\n    drawOpt.sy,\r\n    drawOpt.swidth,\r\n    drawOpt.sheight,\r\n    drawOpt.x,\r\n    drawOpt.y,\r\n    drawOpt.width,\r\n    drawOpt.height\r\n  )\r\n}\r\n\r\nconst drawBackgroundImageToCanvas = (\r\n  ctx,\r\n  width,\r\n  height,\r\n  img,\r\n  { backgroundSize, backgroundPosition, backgroundRepeat },\r\n  callback = () => {}\r\n) => {\r\n  // 画布的长宽比\r\n  let canvasRatio = width / height\r\n  // 加载图片\r\n  let image = new Image()\r\n  image.src = img\r\n  image.onload = () => {\r\n    // 图片的宽度及长宽比\r\n    let imgWidth = image.width\r\n    let imgHeight = image.height\r\n    let imageRatio = imgWidth / imgHeight\r\n    // 绘制图片\r\n    // drawImage方法的参数值\r\n    let drawOpt = {\r\n      sx: 0,\r\n      sy: 0,\r\n      swidth: imgWidth,\r\n      sheight: imgHeight,\r\n      x: 0,\r\n      y: 0,\r\n      width: imgWidth,\r\n      height: imgHeight\r\n    }\r\n    // 模拟background-size\r\n    handleBackgroundSize({\r\n      backgroundSize,\r\n      drawOpt,\r\n      imageRatio,\r\n      canvasWidth: width,\r\n      canvasHeight: height,\r\n      canvasRatio\r\n    })\r\n\r\n    // 模拟background-position\r\n    handleBackgroundPosition({\r\n      backgroundPosition,\r\n      drawOpt,\r\n      imgWidth: drawOpt.width,\r\n      imgHeight: drawOpt.height,\r\n      imageRatio,\r\n      canvasWidth: width,\r\n      canvasHeight: height,\r\n      canvasRatio\r\n    })\r\n\r\n    // 模拟background-repeat\r\n    let notNeedDraw = handleBackgroundRepeat({\r\n      ctx,\r\n      image,\r\n      backgroundRepeat,\r\n      drawOpt,\r\n      imgWidth: drawOpt.width,\r\n      imgHeight: drawOpt.height,\r\n      imageRatio,\r\n      canvasWidth: width,\r\n      canvasHeight: height,\r\n      canvasRatio\r\n    })\r\n\r\n    //  绘制图片\r\n    if (!notNeedDraw) {\r\n      drawImage(ctx, image, drawOpt)\r\n    }\r\n\r\n    callback()\r\n  }\r\n  image.onerror = e => {\r\n    callback(e)\r\n  }\r\n}\r\n\r\nexport default drawBackgroundImageToCanvas\r\n", "import { walk, nodeRichTextToTextWithWrap } from '../utils'\r\n\r\nconst getNodeText = data => {\r\n  return data.richText ? nodeRichTextToTextWithWrap(data.text) : data.text\r\n}\r\n\r\nconst getTitleMark = level => {\r\n  return new Array(level).fill('#').join('')\r\n}\r\n\r\nconst getIndentMark = level => {\r\n  return new Array(level - 6).fill('   ').join('') + '*'\r\n}\r\n\r\n// 转换成markdown格式\r\nexport const transformToMarkdown = root => {\r\n  let content = ''\r\n  walk(\r\n    root,\r\n    null,\r\n    (node, parent, isRoot, layerIndex) => {\r\n      const level = layerIndex + 1\r\n      if (level <= 6) {\r\n        content += getTitleMark(level)\r\n      } else {\r\n        content += getIndentMark(level)\r\n      }\r\n      content += ' ' + getNodeText(node.data)\r\n      // 概要\r\n      const generalization = node.data.generalization\r\n      if (Array.isArray(generalization)) {\r\n        content += generalization.map(item => {\r\n          return ` [${getNodeText(item)}]`\r\n        })\r\n      } else if (generalization && generalization.text) {\r\n        const generalizationText = getNodeText(generalization)\r\n        content += ` [${generalizationText}]`\r\n      }\r\n      content += '\\n\\n'\r\n      // 备注\r\n      if (node.data.note) {\r\n        content += node.data.note + '\\n\\n'\r\n      }\r\n    },\r\n    () => {},\r\n    true\r\n  )\r\n  return content\r\n}\r\n", "import { walk, nodeRichTextToTextWithWrap } from '../utils'\r\n\r\nconst getNodeText = data => {\r\n  return data.richText ? nodeRichTextToTextWithWrap(data.text) : data.text\r\n}\r\n\r\nconst getIndent = level => {\r\n  return new Array(level).fill('   ').join('')\r\n}\r\n\r\n// 转换成txt格式\r\nexport const transformToTxt = root => {\r\n  let content = ''\r\n  walk(\r\n    root,\r\n    null,\r\n    (node, parent, isRoot, layerIndex) => {\r\n      content += getIndent(layerIndex)\r\n      content += ' ' + getNodeText(node.data)\r\n      // 概要\r\n      const generalization = node.data.generalization\r\n      if (Array.isArray(generalization)) {\r\n        content += generalization.map(item => {\r\n          return ` [${getNodeText(item)}]`\r\n        })\r\n      } else if (generalization && generalization.text) {\r\n        content += ` [${getNodeText(generalization)}]`\r\n      }\r\n      content += '\\n\\n'\r\n    },\r\n    () => {},\r\n    true\r\n  )\r\n  return content\r\n}\r\n", "import {\r\n  imgToDataUrl,\r\n  downloadFile,\r\n  readBlob,\r\n  removeHTMLEntities,\r\n  resizeImgSize,\r\n  handleSelfCloseTags,\r\n  addXmlns\r\n} from '../utils'\r\nimport { SVG } from '@svgdotjs/svg.js'\r\nimport drawBackgroundImageToCanvas from '../utils/simulateCSSBackgroundInCanvas'\r\nimport { transformToMarkdown } from '../parse/toMarkdown'\r\nimport { ERROR_TYPES } from '../constants/constant'\r\nimport { transformToTxt } from '../parse/toTxt'\r\n\r\n//  导出插件\r\nclass Export {\r\n  //  构造函数\r\n  constructor(opt) {\r\n    this.mindMap = opt.mindMap\r\n  }\r\n\r\n  //  导出\r\n  async export(type, isDownload = true, name = '思维导图', ...args) {\r\n    if (this[type]) {\r\n      const result = await this[type](name, ...args)\r\n      if (isDownload) {\r\n        downloadFile(result, name + '.' + type)\r\n      }\r\n      return result\r\n    } else {\r\n      return null\r\n    }\r\n  }\r\n\r\n  // 创建图片url转换任务\r\n  createTransformImgTaskList(svg, tagName, propName, getUrlFn) {\r\n    const imageList = svg.find(tagName)\r\n    return imageList.map(async item => {\r\n      const imgUlr = getUrlFn(item)\r\n      // 已经是data:URL形式不用转换\r\n      if (/^data:/.test(imgUlr) || imgUlr === 'none') {\r\n        return\r\n      }\r\n      const imgData = await imgToDataUrl(imgUlr)\r\n      item.attr(propName, imgData)\r\n    })\r\n  }\r\n\r\n  //  获取svg数据\r\n  async getSvgData(node) {\r\n    let {\r\n      exportPaddingX,\r\n      exportPaddingY,\r\n      errorHandler,\r\n      resetCss,\r\n      addContentToHeader,\r\n      addContentToFooter,\r\n      handleBeingExportSvg\r\n    } = this.mindMap.opt\r\n    let { svg, svgHTML, clipData } = this.mindMap.getSvgData({\r\n      paddingX: exportPaddingX,\r\n      paddingY: exportPaddingY,\r\n      addContentToHeader,\r\n      addContentToFooter,\r\n      node\r\n    })\r\n    if (clipData) {\r\n      clipData.paddingX = exportPaddingX\r\n      clipData.paddingY = exportPaddingY\r\n    }\r\n    let svgIsChange = false\r\n    // svg的image标签，把图片的url转换成data:url类型，否则导出会丢失图片\r\n    const task1 = this.createTransformImgTaskList(\r\n      svg,\r\n      'image',\r\n      'href',\r\n      item => {\r\n        return item.attr('href') || item.attr('xlink:href')\r\n      }\r\n    )\r\n    // html的img标签\r\n    const task2 = this.createTransformImgTaskList(svg, 'img', 'src', item => {\r\n      return item.attr('src')\r\n    })\r\n    const taskList = [...task1, ...task2]\r\n    try {\r\n      await Promise.all(taskList)\r\n    } catch (error) {\r\n      errorHandler(ERROR_TYPES.EXPORT_LOAD_IMAGE_ERROR, error)\r\n    }\r\n    // 开启了节点富文本编辑，需要增加一些样式\r\n    if (this.mindMap.richText) {\r\n      const foreignObjectList = svg.find('foreignObject')\r\n      if (foreignObjectList.length > 0) {\r\n        foreignObjectList[0].add(SVG(`<style>${resetCss}</style>`))\r\n        svgIsChange = true\r\n      }\r\n      // 如果还开启了数学公式，还要插入katex库的样式\r\n      if (this.mindMap.formula) {\r\n        const formulaList = svg.find('.ql-formula')\r\n        if (formulaList.length > 0) {\r\n          const styleText = this.mindMap.formula.getStyleText()\r\n          if (styleText) {\r\n            const styleEl = document.createElement('style')\r\n            styleEl.innerHTML = styleText\r\n            addXmlns(styleEl)\r\n            foreignObjectList[0].add(styleEl)\r\n            svgIsChange = true\r\n          }\r\n        }\r\n      }\r\n    }\r\n    // 自定义处理svg的方法\r\n    if (typeof handleBeingExportSvg === 'function') {\r\n      svgIsChange = true\r\n      svg = handleBeingExportSvg(svg)\r\n    }\r\n    // svg节点内容有变，需要重新获取html字符串\r\n    if (taskList.length > 0 || svgIsChange) {\r\n      svgHTML = svg.svg()\r\n    }\r\n    return {\r\n      node: svg,\r\n      str: svgHTML,\r\n      clipData\r\n    }\r\n  }\r\n\r\n  //   svg转png\r\n  svgToPng(svgSrc, transparent, clipData = null) {\r\n    return new Promise((resolve, reject) => {\r\n      const img = new Image()\r\n      // 跨域图片需要添加这个属性，否则画布被污染了无法导出图片\r\n      img.setAttribute('crossOrigin', 'anonymous')\r\n      img.onload = async () => {\r\n        try {\r\n          const canvas = document.createElement('canvas')\r\n          const dpr = Math.max(\r\n            window.devicePixelRatio,\r\n            this.mindMap.opt.minExportImgCanvasScale\r\n          )\r\n          let imgWidth = img.width\r\n          let imgHeight = img.height\r\n          // 如果是裁减操作的话，那么需要手动添加内边距，及调整图片大小为实际的裁减区域的大小，不要忘了内边距哦\r\n          let paddingX = 0\r\n          let paddingY = 0\r\n          if (clipData) {\r\n            paddingX = clipData.paddingX\r\n            paddingY = clipData.paddingY\r\n            imgWidth = clipData.width + paddingX * 2\r\n            imgHeight = clipData.height + paddingY * 2\r\n          }\r\n          // 检查是否超出canvas支持的像素上限\r\n          const maxSize = 16384 / dpr\r\n          const maxArea = maxSize * maxSize\r\n          if (imgWidth * imgHeight > maxArea) {\r\n            let newWidth = null\r\n            let newHeight = null\r\n            if (imgWidth > maxSize) {\r\n              newWidth = maxArea / imgHeight\r\n            } else if (imgHeight > maxSize) {\r\n              newHeight = maxArea / imgWidth\r\n            }\r\n            const res = resizeImgSize(imgWidth, imgHeight, newWidth, newHeight)\r\n            imgWidth = res[0]\r\n            imgHeight = res[1]\r\n          }\r\n          canvas.width = imgWidth * dpr\r\n          canvas.height = imgHeight * dpr\r\n          canvas.style.width = imgWidth + 'px'\r\n          canvas.style.height = imgHeight + 'px'\r\n          const ctx = canvas.getContext('2d')\r\n          ctx.scale(dpr, dpr)\r\n          // 绘制背景\r\n          if (!transparent) {\r\n            await this.drawBackgroundToCanvas(ctx, imgWidth, imgHeight)\r\n          }\r\n          // 图片绘制到canvas里\r\n          // 如果有裁减数据，那么需要进行裁减\r\n          if (clipData) {\r\n            ctx.drawImage(\r\n              img,\r\n              clipData.left,\r\n              clipData.top,\r\n              clipData.width,\r\n              clipData.height,\r\n              paddingX,\r\n              paddingY,\r\n              clipData.width,\r\n              clipData.height\r\n            )\r\n          } else {\r\n            ctx.drawImage(img, 0, 0, imgWidth, imgHeight)\r\n          }\r\n          resolve(canvas.toDataURL())\r\n        } catch (error) {\r\n          reject(error)\r\n        }\r\n      }\r\n      img.onerror = e => {\r\n        reject(e)\r\n      }\r\n      img.src = svgSrc\r\n    })\r\n  }\r\n\r\n  //  在canvas上绘制思维导图背景\r\n  drawBackgroundToCanvas(ctx, width, height) {\r\n    return new Promise((resolve, reject) => {\r\n      const {\r\n        backgroundColor = '#fff',\r\n        backgroundImage,\r\n        backgroundRepeat = 'no-repeat',\r\n        backgroundPosition = 'center center',\r\n        backgroundSize = 'cover'\r\n      } = this.mindMap.themeConfig\r\n      // 背景颜色\r\n      ctx.save()\r\n      ctx.rect(0, 0, width, height)\r\n      ctx.fillStyle = backgroundColor\r\n      ctx.fill()\r\n      ctx.restore()\r\n      // 背景图片\r\n      if (backgroundImage && backgroundImage !== 'none') {\r\n        ctx.save()\r\n        drawBackgroundImageToCanvas(\r\n          ctx,\r\n          width,\r\n          height,\r\n          backgroundImage,\r\n          {\r\n            backgroundRepeat,\r\n            backgroundPosition,\r\n            backgroundSize\r\n          },\r\n          err => {\r\n            if (err) {\r\n              reject(err)\r\n            } else {\r\n              resolve()\r\n            }\r\n            ctx.restore()\r\n          }\r\n        )\r\n      } else {\r\n        resolve()\r\n      }\r\n    })\r\n  }\r\n\r\n  //  在svg上绘制思维导图背景\r\n  drawBackgroundToSvg(svg) {\r\n    return new Promise(async resolve => {\r\n      const {\r\n        backgroundColor = '#fff',\r\n        backgroundImage,\r\n        backgroundRepeat = 'repeat'\r\n      } = this.mindMap.themeConfig\r\n      // 背景颜色\r\n      svg.css('background-color', backgroundColor)\r\n      // 背景图片\r\n      if (backgroundImage && backgroundImage !== 'none') {\r\n        const imgDataUrl = await imgToDataUrl(backgroundImage)\r\n        svg.css('background-image', `url(${imgDataUrl})`)\r\n        svg.css('background-repeat', backgroundRepeat)\r\n        resolve()\r\n      } else {\r\n        resolve()\r\n      }\r\n    })\r\n  }\r\n\r\n  //  导出为png\r\n  /**\r\n   * 方法1.把svg的图片都转化成data:url格式，再转换\r\n   * 方法2.把svg的图片提取出来再挨个绘制到canvas里，最后一起转换\r\n   */\r\n  async png(name, transparent = false, node = null) {\r\n    this.handleNodeExport(node)\r\n    const { str, clipData } = await this.getSvgData(node)\r\n    const svgUrl = await this.fixSvgStrAndToBlob(str)\r\n    const res = await this.svgToPng(svgUrl, transparent, clipData)\r\n    return res\r\n  }\r\n\r\n  // 导出指定节点，如果该节点是激活状态，那么取消激活和隐藏展开收起按钮\r\n  handleNodeExport(node) {\r\n    if (node && node.getData('isActive')) {\r\n      node.deactivate()\r\n      const { alwaysShowExpandBtn, notShowExpandBtn } = this.mindMap.opt\r\n      if (!alwaysShowExpandBtn && !notShowExpandBtn && node.getData('expand')) {\r\n        node.removeExpandBtn()\r\n      }\r\n    }\r\n  }\r\n\r\n  //  导出为pdf\r\n  async pdf(name, transparent = false) {\r\n    if (!this.mindMap.doExportPDF) {\r\n      throw new Error('请注册ExportPDF插件')\r\n    }\r\n    const img = await this.png(name, transparent)\r\n    // 使用jspdf库\r\n    // await this.mindMap.doExportPDF.pdf(name, img)\r\n    // 使用pdf-lib库\r\n    const res = await this.mindMap.doExportPDF.pdf(img)\r\n    return res\r\n  }\r\n\r\n  // 导出为xmind\r\n  async xmind(name) {\r\n    if (!this.mindMap.doExportXMind) {\r\n      throw new Error('请注册ExportXMind插件')\r\n    }\r\n    const data = this.mindMap.getData()\r\n    const blob = await this.mindMap.doExportXMind.xmind(data, name)\r\n    const res = await readBlob(blob)\r\n    return res\r\n  }\r\n\r\n  //  导出为svg\r\n  async svg(name) {\r\n    const { node } = await this.getSvgData()\r\n    node.first().before(SVG(`<title>${name}</title>`))\r\n    await this.drawBackgroundToSvg(node)\r\n    const str = node.svg()\r\n    const res = await this.fixSvgStrAndToBlob(str)\r\n    return res\r\n  }\r\n\r\n  // 修复svg字符串，并且转换为blob数据\r\n  async fixSvgStrAndToBlob(str) {\r\n    // 移除字符串中的html实体\r\n    str = removeHTMLEntities(str)\r\n    // 给html自闭合标签添加闭合状态\r\n    str = handleSelfCloseTags(str)\r\n    // 转换成blob数据\r\n    const blob = new Blob([str], {\r\n      type: 'image/svg+xml'\r\n    })\r\n    const res = await readBlob(blob)\r\n    return res\r\n  }\r\n\r\n  //  导出为json\r\n  async json(name, withConfig = true) {\r\n    const data = this.mindMap.getData(withConfig)\r\n    const str = JSON.stringify(data)\r\n    const blob = new Blob([str])\r\n    const res = await readBlob(blob)\r\n    return res\r\n  }\r\n\r\n  //  专有文件，其实就是json文件\r\n  async smm(name, withConfig) {\r\n    const res = await this.json(name, withConfig)\r\n    return res\r\n  }\r\n\r\n  // markdown文件\r\n  async md() {\r\n    const data = this.mindMap.getData()\r\n    const content = transformToMarkdown(data)\r\n    const blob = new Blob([content])\r\n    const res = await readBlob(blob)\r\n    return res\r\n  }\r\n\r\n  // txt文件\r\n  async txt() {\r\n    const data = this.mindMap.getData()\r\n    const content = transformToTxt(data)\r\n    const blob = new Blob([content])\r\n    const res = await readBlob(blob)\r\n    return res\r\n  }\r\n}\r\n\r\nExport.instanceName = 'doExport'\r\n\r\nexport default Export\r\n"],
  "mappings": "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",
  "names": ["getNodeText"]
}
